
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>API references &#8212; ChaosMagPy  documentation</title>
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/copybutton.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Changelog" href="changelog.html" />
    <link rel="prev" title="Usage" href="usage.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="changelog.html" title="Changelog"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="usage.html" title="Usage"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">ChaosMagPy  documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="api-references">
<h1>API references<a class="headerlink" href="#api-references" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-chaos">
<span id="core-functionality-chaos"></span><h2>Core functionality (<cite>CHAOS</cite>)<a class="headerlink" href="#module-chaos" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="chaos.CHAOS">
<em class="property">class </em><code class="descclassname">chaos.</code><code class="descname">CHAOS</code><span class="sig-paren">(</span><em>breaks=None</em>, <em>order=None</em>, <em>*</em>, <em>coeffs_tdep=None</em>, <em>coeffs_static=None</em>, <em>coeffs_sm=None</em>, <em>coeffs_gsm=None</em>, <em>breaks_delta=None</em>, <em>coeffs_delta=None</em>, <em>breaks_euler=None</em>, <em>coeffs_euler=None</em>, <em>version=None</em><span class="sig-paren">)</span><a class="headerlink" href="#chaos.CHAOS" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for the time-dependent geomagnetic field model CHAOS. Currently only
CHAOS-6 is supported.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>breaks</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (m+1,)</span></dt>
<dd><p class="first last">Break points for piecewise-polynomial representation of the
time-dependent internal (i.e. large-scale core) field in modified
Julian date format.</p>
</dd>
<dt><strong>order</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive</span></dt>
<dd><p class="first last">Order <cite>k</cite> of polynomial pieces (e.g. 4 = cubic) of the time-dependent
internal field.</p>
</dd>
<dt><strong>coeffs_tdep</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (<cite>k</cite>, <cite>m</cite>, <code class="docutils literal notranslate"><span class="pre">n_tdep</span></code> * (<code class="docutils literal notranslate"><span class="pre">n_tdep</span></code> + 2))</span></dt>
<dd><p class="first last">Coefficients of the time-dependent internal field as piecewise
polynomial.</p>
</dd>
<dt><strong>coeffs_static</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray,  shape (<code class="docutils literal notranslate"><span class="pre">n_static</span></code> * (<code class="docutils literal notranslate"><span class="pre">n_static</span></code> + 2),)</span></dt>
<dd><p class="first last">Coefficients of the static internal (i.e. small-scale crustal) field.</p>
</dd>
<dt><strong>coeffs_sm</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (<code class="docutils literal notranslate"><span class="pre">n_sm</span></code> * (<code class="docutils literal notranslate"><span class="pre">n_sm</span></code> + 2),)</span></dt>
<dd><p class="first last">Coefficients of the static external field in SM coordinates.</p>
</dd>
<dt><strong>coeffs_gsm</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (<code class="docutils literal notranslate"><span class="pre">n_gsm</span></code> * (<code class="docutils literal notranslate"><span class="pre">n_gsm</span></code> + 2),)</span></dt>
<dd><p class="first last">Coefficients of the static external field in GSM coordinates.</p>
</dd>
<dt><strong>breaks_delta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict with ndarrays, shape (<span class="math notranslate nohighlight">\(m_q\)</span> + 1,)</span></dt>
<dd><p class="first last">Breaks of baseline corrections of static external field in SM
coordinates. The dictionary keys are <code class="docutils literal notranslate"><span class="pre">'q10'</span></code>, <code class="docutils literal notranslate"><span class="pre">'q11'</span></code>, <code class="docutils literal notranslate"><span class="pre">'s11'</span></code>.</p>
</dd>
<dt><strong>coeffs_delta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict with ndarrays, shape (<span class="math notranslate nohighlight">\(m_q\)</span>,)</span></dt>
<dd><p class="first last">Coefficients of baseline corrections of static external field in SM
coordinates. The dictionary keys are <code class="docutils literal notranslate"><span class="pre">'q10'</span></code>, <code class="docutils literal notranslate"><span class="pre">'q11'</span></code>, <code class="docutils literal notranslate"><span class="pre">'s11'</span></code>.</p>
</dd>
<dt><strong>breaks_euler</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict with ndarrays, shape (<span class="math notranslate nohighlight">\(m_e\)</span> + 1,)</span></dt>
<dd><p class="first last">Dictionary containing satellite name as key and corresponding break
vectors of Euler angles (keys are <code class="docutils literal notranslate"><span class="pre">'oersted'</span></code>, <code class="docutils literal notranslate"><span class="pre">'champ'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'sac_c'</span></code>, <code class="docutils literal notranslate"><span class="pre">'swarm_a'</span></code>, <code class="docutils literal notranslate"><span class="pre">'swarm_b'</span></code>, <code class="docutils literal notranslate"><span class="pre">'swarm_c'</span></code>).</p>
</dd>
<dt><strong>coeffs_euler</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict with ndarrays, shape (1, <span class="math notranslate nohighlight">\(m_e\)</span>, 3)</span></dt>
<dd><p class="first last">Dictionary containing satellite name as key and arrays of the Euler
angles alpha, beta and gamma as trailing dimension (keys are
<code class="docutils literal notranslate"><span class="pre">'oersted'</span></code>, <code class="docutils literal notranslate"><span class="pre">'champ'</span></code>, <code class="docutils literal notranslate"><span class="pre">'sac_c'</span></code>, <code class="docutils literal notranslate"><span class="pre">'swarm_a'</span></code>, <code class="docutils literal notranslate"><span class="pre">'swarm_b'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'swarm_c'</span></code>).</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>Create a time-dependent internal field model as a piecewise polynomial of
order 4 (i.e. cubic) having 10 pieces, spanning the first 50 days in the
year 2000 (breaks in modified Julian date 2000). As example, choose random
coefficients for the time-dependent field of spherical harmonic degree 1
(= 3 coefficients).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">chaosmagpy</span> <span class="kn">as</span> <span class="nn">cp</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="c1"># define model</span>
<span class="n">m</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># number of pieces</span>
<span class="n">breaks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1"># polynomial order</span>
<span class="n">coeffs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

<span class="c1"># create CHAOS class instance</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">CHAOS</span><span class="p">(</span><span class="n">breaks</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">coeffs_tdep</span><span class="o">=</span><span class="n">coeffs</span><span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">n_tdep</span>  <span class="c1"># check degree of time-dependent model, should be 1</span>
</pre></div>
</div>
<p>Now, plot for example the field map on January 2, 2000 0:00 UTC</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">plot_tdep_map</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Save the Gauss coefficients of the time-dependent field in shc-format to
the current working directory.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">save_shcfile</span><span class="p">(</span><span class="s1">&#39;CHAOS-6-x7_tdep.shc&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="s1">&#39;tdep&#39;</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Attributes:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>timestamp</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">UTC timestamp at initialization.</p>
</dd>
<dt><strong>breaks</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (m+1,)</span></dt>
<dd><p class="first last">Break points for piecewise-polynomial representation of the
time-dependent internal field in modified Julian date format.</p>
</dd>
<dt><strong>pieces</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive</span></dt>
<dd><p class="first last">Number <cite>m</cite> of intervals given by break points in <code class="docutils literal notranslate"><span class="pre">breaks</span></code>.</p>
</dd>
<dt><strong>order</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive</span></dt>
<dd><p class="first last">Order <cite>k</cite> of polynomial pieces (e.g. 4 = cubic) of the time-dependent
internal field.</p>
</dd>
<dt><strong>n_tdep</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive</span></dt>
<dd><p class="first last">Maximum spherical harmonic degree of the time-dependent internal field.</p>
</dd>
<dt><strong>coeffs_tdep</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (<cite>k</cite>, <cite>m</cite>, <code class="docutils literal notranslate"><span class="pre">n_tdep</span></code> * (<code class="docutils literal notranslate"><span class="pre">n_tdep</span></code> + 2))</span></dt>
<dd><p class="first last">Coefficients of the time-dependent internal field.</p>
</dd>
<dt><strong>n_static</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive</span></dt>
<dd><p class="first last">Maximum spherical harmonic degree of the static internal (i.e.
small-scale crustal) field.</p>
</dd>
<dt><strong>coeffs_static</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray,  shape (<code class="docutils literal notranslate"><span class="pre">n_static</span></code> * (<code class="docutils literal notranslate"><span class="pre">n_static</span></code> + 2),)</span></dt>
<dd><p class="first last">Coefficients of the static internal field.</p>
</dd>
<dt><strong>n_sm</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive</span></dt>
<dd><p class="first last">Maximum spherical harmonic degree of external field in SM coordinates.</p>
</dd>
<dt><strong>coeffs_sm</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (<code class="docutils literal notranslate"><span class="pre">n_sm</span></code> * (<code class="docutils literal notranslate"><span class="pre">n_sm</span></code> + 2),)</span></dt>
<dd><p class="first last">Coefficients of static external field in SM coordinates.</p>
</dd>
<dt><strong>n_gsm</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive</span></dt>
<dd><p class="first last">Maximum spherical harmonic degree of external field in GSM coordinates.</p>
</dd>
<dt><strong>coeffs_gsm</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (<code class="docutils literal notranslate"><span class="pre">n_gsm</span></code> * (<code class="docutils literal notranslate"><span class="pre">n_gsm</span></code> + 2),)</span></dt>
<dd><p class="first last">Coefficients of static external field in GSM coordinates.</p>
</dd>
<dt><strong>breaks_delta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict with ndarrays, shape (<span class="math notranslate nohighlight">\(m_q\)</span> +1,)</span></dt>
<dd><p class="first last">Breaks of baseline corrections of static external field in SM
coordinates. The dictionary keys are <code class="docutils literal notranslate"><span class="pre">'q10'</span></code>, <code class="docutils literal notranslate"><span class="pre">'q11'</span></code>, <code class="docutils literal notranslate"><span class="pre">'s11'</span></code>.</p>
</dd>
<dt><strong>coeffs_delta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict with ndarrays, shape (<span class="math notranslate nohighlight">\(m_q\)</span>,)</span></dt>
<dd><p class="first last">Coefficients of baseline corrections of static external field in SM
coordinates. The dictionary keys are <code class="docutils literal notranslate"><span class="pre">'q10'</span></code>, <code class="docutils literal notranslate"><span class="pre">'q11'</span></code>, <code class="docutils literal notranslate"><span class="pre">'s11'</span></code>.</p>
</dd>
<dt><strong>breaks_euler</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict with ndarrays, shape (<span class="math notranslate nohighlight">\(m_e\)</span> +1,)</span></dt>
<dd><p class="first last">Dictionary containing satellite name as key and corresponding break
vectors of Euler angles (keys are <code class="docutils literal notranslate"><span class="pre">'oersted'</span></code>, <code class="docutils literal notranslate"><span class="pre">'champ'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'sac_c'</span></code>, <code class="docutils literal notranslate"><span class="pre">'swarm_a'</span></code>, <code class="docutils literal notranslate"><span class="pre">'swarm_b'</span></code>, <code class="docutils literal notranslate"><span class="pre">'swarm_c'</span></code>).</p>
</dd>
<dt><strong>coeffs_euler</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict with ndarrays, shape (1, <span class="math notranslate nohighlight">\(m_e\)</span>, 3)</span></dt>
<dd><p class="first last">Dictionary containing satellite name as key and arrays of the Euler
angles alpha, beta and gamma as trailing dimension (keys are
<code class="docutils literal notranslate"><span class="pre">'oersted'</span></code>, <code class="docutils literal notranslate"><span class="pre">'champ'</span></code>, <code class="docutils literal notranslate"><span class="pre">'sac_c'</span></code>, <code class="docutils literal notranslate"><span class="pre">'swarm_a'</span></code>, <code class="docutils literal notranslate"><span class="pre">'swarm_b'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'swarm_c'</span></code>).</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="chaos.CHAOS.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><em>time</em>, <em>radius</em>, <em>theta</em>, <em>phi</em>, <em>source_list=None</em><span class="sig-paren">)</span><a class="headerlink" href="#chaos.CHAOS.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the magnetic field from the CHAOS model using all sources
(time-dependent and static internal field, and external SM/GSM
fields including induced parts).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…) or float</span></dt>
<dd><p class="first last">Array containing the time in modified Julian dates.</p>
</dd>
<dt><strong>radius</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…) or float</span></dt>
<dd><p class="first last">Radius of station in kilometers.</p>
</dd>
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…) or float</span></dt>
<dd><p class="first last">Colatitude in degrees <span class="math notranslate nohighlight">\([0^\circ, 180^\circ]\)</span>.</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…) or float</span></dt>
<dd><p class="first last">Longitude in degrees.</p>
</dd>
<dt><strong>source_list</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list, [‘tdep’, ‘static’, ‘gsm’, ‘sm’]</span></dt>
<dd><p class="first last">Specify sources in any order. Default is all sources.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>B_radius, B_theta, B_phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (grid_shape)</span></dt>
<dd><p class="first last">Radial, colatitude and azimuthal field components.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chaos.CHAOS.__str__">
<code class="descname">__str__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#chaos.CHAOS.__str__" title="Permalink to this definition">¶</a></dt>
<dd><p>Print model version and initialization timestamp.</p>
</dd></dl>

<dl class="method">
<dt id="chaos.CHAOS.plot_external_map">
<code class="descname">plot_external_map</code><span class="sig-paren">(</span><em>time</em>, <em>radius</em>, <em>nmax=None</em>, <em>reference=None</em>, <em>source=None</em><span class="sig-paren">)</span><a class="headerlink" href="#chaos.CHAOS.plot_external_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot global map of the external field from the CHAOS model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (), (1,) or float</span></dt>
<dd><p class="first last">Time given as MJD2000 (modified Julian date).</p>
</dd>
<dt><strong>radius</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (), (1,) or float</span></dt>
<dd><p class="first last">Array containing the radius in kilometers.</p>
</dd>
<dt><strong>nmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive, optional</span></dt>
<dd><p class="first last">Maximum degree harmonic expansion (default is given by the model
coefficients, but can also be smaller, if specified).</p>
</dd>
<dt><strong>reference</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{‘all’, ‘GSM’, ‘SM’}, optional</span></dt>
<dd><p class="first last">Choose contribution either from GSM, SM or both added
(default is ‘all’).</p>
</dd>
<dt><strong>source</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{‘all’, ‘external’, ‘internal’}, optional</span></dt>
<dd><p class="first last">Choose source to be external (inducing), internal (induced) or
both added (default is ‘all’).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>B_radius, B_theta, B_phi</strong></dt>
<dd><p class="first last">Global map of the radial, colatitude and azimuthal field
components.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chaos.CHAOS.plot_static_map">
<code class="descname">plot_static_map</code><span class="sig-paren">(</span><em>radius</em>, <em>nmax=None</em><span class="sig-paren">)</span><a class="headerlink" href="#chaos.CHAOS.plot_static_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot global map of the static internal field from the CHAOS model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>radius</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (), (1,) or float</span></dt>
<dd><p class="first last">Array containing the radius in kilometers.</p>
</dd>
<dt><strong>nmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive, optional</span></dt>
<dd><p class="first last">Maximum degree harmonic expansion (default is given by the model
coefficients, but can also be smaller, if specified).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>B_radius, B_theta, B_phi</strong></dt>
<dd><p class="first last">Global map of the radial, colatitude and azimuthal field
components.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chaos.CHAOS.plot_tdep_map">
<code class="descname">plot_tdep_map</code><span class="sig-paren">(</span><em>time</em>, <em>radius</em>, <em>nmax=None</em>, <em>deriv=None</em><span class="sig-paren">)</span><a class="headerlink" href="#chaos.CHAOS.plot_tdep_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot global map of the time-dependent internal field from the CHAOS
model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (), (1,) or float</span></dt>
<dd><p class="first last">Time given as MJD2000 (modified Julian date).</p>
</dd>
<dt><strong>radius</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (), (1,) or float</span></dt>
<dd><p class="first last">Array containing the radius in kilometers.</p>
</dd>
<dt><strong>nmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive, optional</span></dt>
<dd><p class="first last">Maximum degree harmonic expansion (default is given by the model
coefficients, but can also be smaller, if specified).</p>
</dd>
<dt><strong>deriv</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive, optional</span></dt>
<dd><p class="first last">Derivative in time (default is 0). For secular variation, choose
<code class="docutils literal notranslate"><span class="pre">deriv=1</span></code>.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>B_radius, B_theta, B_phi</strong></dt>
<dd><p class="first last">Global map of the radial, colatitude and azimuthal field
components.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chaos.CHAOS.plot_tdep_timeseries">
<code class="descname">plot_tdep_timeseries</code><span class="sig-paren">(</span><em>radius</em>, <em>theta</em>, <em>phi</em>, <em>nmax=None</em>, <em>deriv=None</em><span class="sig-paren">)</span><a class="headerlink" href="#chaos.CHAOS.plot_tdep_timeseries" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the time series of the time-dependent internal field from the
CHAOS model at a specific location.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>radius</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (), (1,) or float</span></dt>
<dd><p class="first last">Radius of station in kilometers.</p>
</dd>
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (), (1,) or float</span></dt>
<dd><p class="first last">Colatitude in degrees <span class="math notranslate nohighlight">\([0^\circ, 180^\circ]\)</span>.</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (), (1,) or float</span></dt>
<dd><p class="first last">Longitude in degrees.</p>
</dd>
<dt><strong>nmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive, optional</span></dt>
<dd><p class="first last">Maximum degree harmonic expansion (default is given by the model
coefficients, but can also be smaller, if specified).</p>
</dd>
<dt><strong>deriv</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive, optional</span></dt>
<dd><p class="first last">Derivative in time (default is 0). For secular variation, choose
<code class="docutils literal notranslate"><span class="pre">deriv=1</span></code>.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>B_radius, B_theta, B_phi</strong></dt>
<dd><p class="first last">Time series plot of the radial, colatitude and azimuthal field
components.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chaos.CHAOS.save_shcfile">
<code class="descname">save_shcfile</code><span class="sig-paren">(</span><em>filepath</em>, <em>source=None</em>, <em>deriv=None</em><span class="sig-paren">)</span><a class="headerlink" href="#chaos.CHAOS.save_shcfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Save spherical harmonic coefficients to a file in <cite>shc</cite>-format.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>filepath</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">Path and name of output file <cite>*.shc</cite>.</p>
</dd>
<dt><strong>source</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{‘tdep’, ‘static’}, optional</span></dt>
<dd><p class="first last">Choose part of the model to save (default is ‘tdep’).</p>
</dd>
<dt><strong>deriv</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd><p class="first last">Derivative of the time-dependent field (default is 0, ignored for
static source).</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chaos.CHAOS.synth_gsm_field">
<code class="descname">synth_gsm_field</code><span class="sig-paren">(</span><em>time</em>, <em>nmax=None</em>, <em>source=None</em><span class="sig-paren">)</span><a class="headerlink" href="#chaos.CHAOS.synth_gsm_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the external GSM field coefficients from the CHAOS model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…) or float</span></dt>
<dd><p class="first last">Array containing the time in days.</p>
</dd>
<dt><strong>nmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive, optional</span></dt>
<dd><p class="first last">Maximum degree harmonic expansion (default is given by the model
coefficients, but can also be smaller, if specified).</p>
</dd>
<dt><strong>source</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{‘external’, ‘internal’}, optional</span></dt>
<dd><p class="first last">Choose source either external or internal (default is ‘external’).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>coeffs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…, <code class="docutils literal notranslate"><span class="pre">nmax</span></code> * (<code class="docutils literal notranslate"><span class="pre">nmax</span></code> + 2))</span></dt>
<dd><p class="first last">Coefficients of the external GSM field in term of geographic
coordinates (GEO).</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chaos.CHAOS.synth_sm_field">
<code class="descname">synth_sm_field</code><span class="sig-paren">(</span><em>time</em>, <em>nmax=None</em>, <em>source=None</em><span class="sig-paren">)</span><a class="headerlink" href="#chaos.CHAOS.synth_sm_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the external SM field from the CHAOS model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…) or float</span></dt>
<dd><p class="first last">Array containing the time in days.</p>
</dd>
<dt><strong>nmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive, optional</span></dt>
<dd><p class="first last">Maximum degree harmonic expansion (default is given by the model
coefficients, but can also be smaller, if specified).</p>
</dd>
<dt><strong>source</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{‘external’, ‘internal’}, optional</span></dt>
<dd><p class="first last">Choose source either external or internal (default is ‘external’).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>coeffs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…, <code class="docutils literal notranslate"><span class="pre">nmax</span></code> * (<code class="docutils literal notranslate"><span class="pre">nmax</span></code> + 2))</span></dt>
<dd><p class="first last">Coefficients of the external SM field coefficients in terms of
geographic coordinates (GEO).</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chaos.CHAOS.synth_static_field">
<code class="descname">synth_static_field</code><span class="sig-paren">(</span><em>nmax=None</em><span class="sig-paren">)</span><a class="headerlink" href="#chaos.CHAOS.synth_static_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the static internal field coefficients from the CHAOS model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>nmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive, optional</span></dt>
<dd><p class="first last">Maximum degree harmonic expansion (default is given by the model
coefficients, but can also be smaller, if specified).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>coeffs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (<code class="docutils literal notranslate"><span class="pre">nmax</span></code> * (<code class="docutils literal notranslate"><span class="pre">nmax</span></code> + 2),)</span></dt>
<dd><p class="first last">Coefficients of the static internal field.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chaos.CHAOS.synth_tdep_field">
<code class="descname">synth_tdep_field</code><span class="sig-paren">(</span><em>time</em>, <em>nmax=None</em>, <em>deriv=None</em><span class="sig-paren">)</span><a class="headerlink" href="#chaos.CHAOS.synth_tdep_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the time-dependent internal field coefficients from the CHAOS
model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…) or float</span></dt>
<dd><p class="first last">Array containing the time in modified Julian dates.</p>
</dd>
<dt><strong>nmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive, optional</span></dt>
<dd><p class="first last">Maximum degree harmonic expansion (default is given by the model
coefficients, but can also be smaller, if specified).</p>
</dd>
<dt><strong>deriv</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive, optional</span></dt>
<dd><p class="first last">Derivative in time (default is 0). For secular variation, choose
<code class="docutils literal notranslate"><span class="pre">deriv=1</span></code>.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>coeffs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…, <code class="docutils literal notranslate"><span class="pre">nmax</span></code> * (<code class="docutils literal notranslate"><span class="pre">nmax</span></code> + 2))</span></dt>
<dd><p class="first last">Coefficients of the time-dependent internal field.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="chaos.load_CHAOS_matfile">
<code class="descclassname">chaos.</code><code class="descname">load_CHAOS_matfile</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="headerlink" href="#chaos.load_CHAOS_matfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Load CHAOS model from mat-file, e.g. <code class="docutils literal notranslate"><span class="pre">CHAOS-6-x7.mat</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>filepath</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">Path to mat-file containing the CHAOS model.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>model</strong> <span class="classifier-delimiter">:</span> <span class="classifier">CHAOS</span></dt>
<dd><p class="first last">CHAOS class instance.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#chaos.CHAOS" title="chaos.CHAOS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CHAOS</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<p>Load for example the mat-file <code class="docutils literal notranslate"><span class="pre">CHAOS-6-x7.mat</span></code> in the current working
directory like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">chaosmagpy</span> <span class="kn">as</span> <span class="nn">cp</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">load_CHAOS_matfile</span><span class="p">(</span><span class="s1">&#39;CHAOS-6-x7.mat&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="chaos.load_CHAOS_shcfile">
<code class="descclassname">chaos.</code><code class="descname">load_CHAOS_shcfile</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="headerlink" href="#chaos.load_CHAOS_shcfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Load CHAOS model from shc-file, e.g. <code class="docutils literal notranslate"><span class="pre">CHAOS-6-x7_tdep.shc</span></code>. The file
should contain the coefficients or the time-dependent or static internal
part of the CHAOS model. In case of the time-dependent part, a
reconstruction of the piecewise polynomial is performed (only accurate
to 0.01 nT).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>filepath</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">Path to shc-file.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>model</strong> <span class="classifier-delimiter">:</span> <span class="classifier">CHAOS</span></dt>
<dd><p class="first last">CHAOS class instance with the time-dependent or static internal part
initialized.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#chaos.CHAOS" title="chaos.CHAOS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CHAOS</span></code></a>, <a class="reference internal" href="#chaos.load_CHAOS_matfile" title="chaos.load_CHAOS_matfile"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_CHAOS_matfile</span></code></a></p>
</div>
<p class="rubric">Notes</p>
<p>The piecewise polynomial of the time-dependent internal part of the CHAOS
model is contructed from the snapshots of the model, accurately handling
the break-points of the model. Note however that the original coefficients
can only be retrieved to an absolute error of around 0.01 nT, i.e.
small-scale field and higher derivates (&gt;1) are not recommended if
accuracy is important. Use the <code class="docutils literal notranslate"><span class="pre">load_CHAOS_matfile</span></code> function instead.</p>
<p class="rubric">Examples</p>
<p>Load for example the shc-file <code class="docutils literal notranslate"><span class="pre">CHAOS-6-x7_tdep.shc</span></code> in the current
working directory, containing the coefficients of time-dependent internal
part of the CHAOS-6-x7 model.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">chaosmagpy</span> <span class="kn">as</span> <span class="nn">cp</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">load_CHAOS_shcfile</span><span class="p">(</span><span class="s1">&#39;CHAOS-6-x7_tdep.shc&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="additional-functionality">
<h2>Additional functionality<a class="headerlink" href="#additional-functionality" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-coordinate_utils">
<span id="coordinate-transformations-coordinate-utils"></span><h3>Coordinate transformations (<cite>coordinate_utils</cite>)<a class="headerlink" href="#module-coordinate_utils" title="Permalink to this headline">¶</a></h3>
<p>Functions for coordinate transformations.</p>
<p>Abbreviations :</p>
<dl class="docutils">
<dt>GEO <span class="classifier-delimiter">:</span> <span class="classifier">geocentric, orthogonal coordinate system</span></dt>
<dd>With z-axis along Earth’s rotation axis, x-axis pointing to Greenwich and
y-axis completing right-handed coordinate system.</dd>
<dt>USE <span class="classifier-delimiter">:</span> <span class="classifier">local orthogonal coordinate system on spherical surface</span></dt>
<dd>Axes directions are defined as Up-South-East (e.g. B_radius, B_theta,
B_phi in GEO).</dd>
<dt>GSM <span class="classifier-delimiter">:</span> <span class="classifier">geocentric solar magnetic, orthogonal coordinate system</span></dt>
<dd>With x-axis pointing towards the sun, y-axis perpendicular to plane spanned
by Eart-Sun line and dipole axis and z-axis completing right-handed system.</dd>
<dt>SM <span class="classifier-delimiter">:</span> <span class="classifier">solar magnetic, orthogonal coordinate system</span></dt>
<dd>With z-axis along dipole axis, y-axis perpendicular to plane containing the
dipole axis and the Earth-Sun line, and x-axis completing the right-handed
system.</dd>
<dt>MAG <span class="classifier-delimiter">:</span> <span class="classifier">magnetic orthogonal coordinate system (centered dipole)</span></dt>
<dd>With z-axis anti-parallel to IGRF dipole, x-axis in the plane spanned by
the dipole axis and Earth’s rotation axis, and y-axis completing the
right-handed system.</dd>
</dl>
<dl class="function">
<dt id="coordinate_utils.basevectors_gsm">
<code class="descclassname">coordinate_utils.</code><code class="descname">basevectors_gsm</code><span class="sig-paren">(</span><em>time</em><span class="sig-paren">)</span><a class="headerlink" href="#coordinate_utils.basevectors_gsm" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the unit base vectors of the gsm coordinate system with respect to
the geocentric coordinate system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Time given as modified Julian date, i.e. with respect to the date 0h00
January 1, 2000 (mjd2000).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>gsm_1, gsm_2, gsm_3</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…, 3)</span></dt>
<dd><p class="first last">GSM unit base vectors. The leading dimension agrees with the shape of
<code class="docutils literal notranslate"><span class="pre">time</span></code>, while the last dimension contains the unit vector
components in terms of the geocentric coordinate system.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="coordinate_utils.basevectors_mag">
<code class="descclassname">coordinate_utils.</code><code class="descname">basevectors_mag</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#coordinate_utils.basevectors_mag" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the unit base vectors of the central-dipole coordinate system
(sometimes referred to as MAG). The components are given with respect to
the geocentric coordinate system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>mag_1, mag_2, mag_3</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (3,)</span></dt>
<dd><p class="first last">MAG unit base vectors.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="coordinate_utils.basevectors_sm">
<code class="descclassname">coordinate_utils.</code><code class="descname">basevectors_sm</code><span class="sig-paren">(</span><em>time</em><span class="sig-paren">)</span><a class="headerlink" href="#coordinate_utils.basevectors_sm" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the unit base vectors of the sm coordinate system with respect to
the geocentric coordinate system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Time given as modified Julian date, i.e. with respect to the date 0h00
January 1, 2000 (mjd2000).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>sm_1, sm_2, sm_3</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…, 3)</span></dt>
<dd><p class="first last">SM unit base vectors. The leading dimension agrees with the shape of
<code class="docutils literal notranslate"><span class="pre">time</span></code>, while the last dimension contains the unit vector
components in terms of the geocentric coordinate system.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="coordinate_utils.basevectors_use">
<code class="descclassname">coordinate_utils.</code><code class="descname">basevectors_use</code><span class="sig-paren">(</span><em>theta</em>, <em>phi</em><span class="sig-paren">)</span><a class="headerlink" href="#coordinate_utils.basevectors_use" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the unit base vectors of local orthogonal coordinate system USE
(Up-South-East) on spherical surface (theta, phi) with respect to the
geocentric coordinate system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…)</span></dt>
<dd><p class="first last">Geocentric colatitude in degrees <span class="math notranslate nohighlight">\((0^\circ, 180^\circ)\)</span>, i.e.
exclude poles.</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…)</span></dt>
<dd><p class="first last">Geocentric longitude in degrees.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>use_1, use_2, use_3</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…, 3)</span></dt>
<dd><p class="first last">USE unit base vectors. The leading dimension agrees with the shape of
<code class="docutils literal notranslate"><span class="pre">theta</span></code> or <code class="docutils literal notranslate"><span class="pre">phi</span></code>, while the last dimension contains the unit
vector components in terms of the geocentric coordinate system.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="coordinate_utils.cartesian_to_spherical">
<code class="descclassname">coordinate_utils.</code><code class="descname">cartesian_to_spherical</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>z</em><span class="sig-paren">)</span><a class="headerlink" href="#coordinate_utils.cartesian_to_spherical" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert geocentric cartesian to spherical coordinates.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>x,y,z</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd></dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>radius</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Geocentric radius.</p>
</dd>
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Geocentric colatitude in degrees <span class="math notranslate nohighlight">\([0^\circ, 180^\circ]\)</span>.</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Geocentric longitude in degrees <span class="math notranslate nohighlight">\((-180^\circ,180^\circ]\)</span>.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="coordinate_utils.center_azimuth">
<code class="descclassname">coordinate_utils.</code><code class="descname">center_azimuth</code><span class="sig-paren">(</span><em>phi</em><span class="sig-paren">)</span><a class="headerlink" href="#coordinate_utils.center_azimuth" title="Permalink to this definition">¶</a></dt>
<dd><p>Project arbitrary azimuth angles in degrees to semi-open interval
<span class="math notranslate nohighlight">\((-180^\circ, 180^\circ]\)</span>.</p>
</dd></dl>

<dl class="function">
<dt id="coordinate_utils.conducting_sphere">
<code class="descclassname">coordinate_utils.</code><code class="descname">conducting_sphere</code><span class="sig-paren">(</span><em>periods</em>, <em>sigma</em>, <em>radius</em>, <em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#coordinate_utils.conducting_sphere" title="Permalink to this definition">¶</a></dt>
<dd><p>Computation of the response for a spherically layered conductor in an
inducing external field of a single spherical degree.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>periods</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray or float, shape (…,)</span></dt>
<dd><p class="first last">Oscillation period of the inducing field in seconds.</p>
</dd>
<dt><strong>sigma</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (nl,)</span></dt>
<dd><p class="first last">Conductivity of spherical shells, starting with the outermost and
excluding the perfectly conducting innermost sphere in (S/m).</p>
</dd>
<dt><strong>radius</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (nl+1,)</span></dt>
<dd><p class="first last">Radius of the interfaces in between the layers, starting with outermost
layer in kilometers (i.e. conductor surface, see Notes).</p>
</dd>
<dt><strong>n</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Spherical degree of inducing external field.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>C</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…,)</span></dt>
<dd><p class="first last">C-response, complex.</p>
</dd>
<dt><strong>rho_a</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…,)</span></dt>
<dd><p class="first last">Electrical surface resistance in (Omega*m).</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…,)</span></dt>
<dd><p class="first last">Proportional to phase angle of response in degrees.</p>
</dd>
<dt><strong>Q</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…,)</span></dt>
<dd><p class="first last">Q-response, complex.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The following applies to the layered conductivity shells:</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">radius[0]</span></code> &gt; <cite>r</cite> &gt; <code class="docutils literal notranslate"><span class="pre">radius[1]</span></code> : <code class="docutils literal notranslate"><span class="pre">sigma[0]</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">radius[1]</span></code> &gt; <cite>r</cite> &gt; <code class="docutils literal notranslate"><span class="pre">radius[2]</span></code> : <code class="docutils literal notranslate"><span class="pre">sigma[1]</span></code></div>
<div class="line">…</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">radius[nl-1]</span></code> &gt; <cite>r</cite> &gt; <code class="docutils literal notranslate"><span class="pre">radius[nl]</span></code> : <code class="docutils literal notranslate"><span class="pre">sigma[nl-1]</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">radius[nl+1]</span></code> &gt; <cite>r</cite> &gt; 0 :      <span class="math notranslate nohighlight">\(\sigma\)</span> = <cite>inf</cite></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">nl</span></code> is number of uniform layers (excluding a perfectly conducting core),
radius in km, conductivity <span class="math notranslate nohighlight">\(\sigma\)</span> in (S/m)</p>
<p>The program should work also for very small periods, where it
models the response of a layered plane conductor</p>
<div class="line-block">
<div class="line">Python version: August 2018, Clemens Kloss</div>
<div class="line">Matlab version: November 2000, Nils Olsen</div>
<div class="line">Original Fortran program: Peter Weidelt</div>
</div>
</dd></dl>

<dl class="function">
<dt id="coordinate_utils.geo_to_base">
<code class="descclassname">coordinate_utils.</code><code class="descname">geo_to_base</code><span class="sig-paren">(</span><em>theta</em>, <em>phi</em>, <em>base_1</em>, <em>base_2</em>, <em>base_3</em>, <em>inverse=False</em><span class="sig-paren">)</span><a class="headerlink" href="#coordinate_utils.geo_to_base" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms spherical geographic coordinates into spherical coordinates of a
rotated reference system as given by three base vectors.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Geocentric colatitude in degrees.</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Geocentric longitude in degrees.</p>
</dd>
<dt><strong>base_1, base_2, base_3</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (3,) or (…, 3)</span></dt>
<dd><p class="first last">Base vector 1 through 3 having components with respect to GEO.</p>
</dd>
<dt><strong>inverse</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd><p class="first last">Use inverse transformation instead, i.e. transform from rotated to
geographic (default is False).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…)</span></dt>
<dd><p class="first last">Reference colatitude in degrees <span class="math notranslate nohighlight">\([0^\circ, 180^\circ]\)</span>.</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…)</span></dt>
<dd><p class="first last">Reference longitude in degrees <span class="math notranslate nohighlight">\((-180^\circ, 180^\circ]\)</span>.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#coordinate_utils.transform_points" title="coordinate_utils.transform_points"><code class="xref py py-obj docutils literal notranslate"><span class="pre">transform_points</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="coordinate_utils.igrf_dipole">
<code class="descclassname">coordinate_utils.</code><code class="descname">igrf_dipole</code><span class="sig-paren">(</span><em>epoch=None</em><span class="sig-paren">)</span><a class="headerlink" href="#coordinate_utils.igrf_dipole" title="Permalink to this definition">¶</a></dt>
<dd><p>Unit vector that is anti-parallel to the IGRF dipole, i.e. pointing towards
the dipole’s South Pole (located in the Northern Hemisphere). Epoch 2015 of
IGRF-12 is used by default.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>epoch</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{‘2015’, ‘2010’}, optional</span></dt>
<dd><p class="first last">Epoch of IGRF-12 (2015) and IGRF-11 (2010, default).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>dipole</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (3,)</span></dt>
<dd><p class="first last">Unit vector pointing to magnetic South Pole.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="coordinate_utils.matrix_geo_to_base">
<code class="descclassname">coordinate_utils.</code><code class="descname">matrix_geo_to_base</code><span class="sig-paren">(</span><em>theta</em>, <em>phi</em>, <em>base_1</em>, <em>base_2</em>, <em>base_3</em>, <em>inverse=False</em><span class="sig-paren">)</span><a class="headerlink" href="#coordinate_utils.matrix_geo_to_base" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes matrix to rotate vectors from USE frame at spherical geographic
coordinates (theta, phi) to USE frame at spherical reference coordinates
defined by a set of base vectors.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Geocentric colatitude in degrees.</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Geocentric longtiude in degrees.</p>
</dd>
<dt><strong>base_1, base_2, base_3</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…, 3)</span></dt>
<dd><p class="first last">Base vectors 1 through 3 as columns with respect to GEO.</p>
</dd>
<dt><strong>inverse</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd><p class="first last">Use inverse transformation instead, i.e. transform from rotated
coordinates to geographic (default is False).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…)</span></dt>
<dd><p class="first last">Reference colatitude in degrees <span class="math notranslate nohighlight">\([0^\circ, 180^\circ]\)</span>.</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…)</span></dt>
<dd><p class="first last">Reference longitude in degrees <span class="math notranslate nohighlight">\((-180^\circ, 180^\circ]\)</span>.</p>
</dd>
<dt><strong>R</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…, 3, 3), optional</span></dt>
<dd><p class="first">Array of matrices that rotates vectors B in spherical GEO to the target
spherical reference. The matrices (3x3) reside in the last two
dimensions, while the leading dimensions are identical to the input
grid.</p>
<div class="last line-block">
<div class="line">B_radius_ref = B_radius</div>
<div class="line">B_theta_ref  = R[1, 1]*B_theta + R[1, 2]*B_phi</div>
<div class="line">B_phi_ref    = R[2, 1]*B_theta + R[2, 2]*B_phi</div>
</div>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#coordinate_utils.transform_vectors" title="coordinate_utils.transform_vectors"><code class="xref py py-obj docutils literal notranslate"><span class="pre">transform_vectors</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="coordinate_utils.mjd2000">
<code class="descclassname">coordinate_utils.</code><code class="descname">mjd2000</code><span class="sig-paren">(</span><em>year</em>, <em>month</em>, <em>day</em>, <em>hour=0</em>, <em>minute=0</em>, <em>second=0</em><span class="sig-paren">)</span><a class="headerlink" href="#coordinate_utils.mjd2000" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the modified Julian date as floating point number. It assigns 0 to
0h00 January 1, 2000. Leap seconds are not accounted for.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>year</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd></dd>
<dt><strong>month</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Month of the year <cite>[1, 12]</cite>.</p>
</dd>
<dt><strong>day</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Day of the corresponding month.</p>
</dd>
<dt><strong>hour</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd><p class="first last">Hour of the day <cite>[0, 23]</cite> (default is 0).</p>
</dd>
<dt><strong>minute</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd><p class="first last">Minutes of the hour <cite>[0, 59]</cite> (default is 0).</p>
</dd>
<dt><strong>second</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd><p class="first last">Seconds of the hour <cite>[0, 59]</cite> (default is 0).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>mjd</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Modified Julian date in units of days.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="coordinate_utils.q_response">
<code class="descclassname">coordinate_utils.</code><code class="descname">q_response</code><span class="sig-paren">(</span><em>frequency</em>, <em>nmax</em><span class="sig-paren">)</span><a class="headerlink" href="#coordinate_utils.q_response" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the Q-response given a conductivity model of Earth, which is
loaded during the computation (from
<code class="docutils literal notranslate"><span class="pre">chaosmagpy/lib/Earth_conductivity.dat</span></code>).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>frequency</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (N,)</span></dt>
<dd><p class="first last">Vector of N frequencies (1/sec) for which to compute Q-response.</p>
</dd>
<dt><strong>nmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Maximum spherical harmonic degree of inducing field.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>q_response</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (nmax, N)</span></dt>
<dd><p class="first last">Q-response for every frequency and harmonic degree of inducing
field. Index 0 corresponds to degree 1, index 1 corresponds to degree
2, and so on.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="coordinate_utils.rotate_gauss">
<code class="descclassname">coordinate_utils.</code><code class="descname">rotate_gauss</code><span class="sig-paren">(</span><em>nmax</em>, <em>kmax</em>, <em>base_1</em>, <em>base_2</em>, <em>base_3</em><span class="sig-paren">)</span><a class="headerlink" href="#coordinate_utils.rotate_gauss" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the matrix to transform spherical harmonic expansion given with
respect to a rotated coordinate system to the standard geographic
reference (GEO). The rotated coordinate system is described by 3 orthogonal
base vectors with components in GEO coordinates.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>nmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Maximum degree of spherical harmonic expansion with respect to
geographic reference (target reference system).</p>
</dd>
<dt><strong>kmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Maximum degree of spherical harmonic expansion with respect to rotated
reference system.</p>
</dd>
<dt><strong>base_1, base_2, base_3</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…, 3)</span></dt>
<dd><p class="first last">Base vectors of rotated reference system given in terms of the
target reference system. Vectors reside in the last dimension.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>matrix</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…, <code class="docutils literal notranslate"><span class="pre">nmax</span></code> * (<code class="docutils literal notranslate"><span class="pre">nmax</span></code> + 2), <code class="docutils literal notranslate"><span class="pre">kmax</span></code> * (<code class="docutils literal notranslate"><span class="pre">kmax</span></code> + 2))</span></dt>
<dd><p class="first">Matrices reside in last two dimensions. They transform spherical
harmonic coefficients of rotated reference (e.g. GSM) to standard
geographic reference (GEO):</p>
<p class="last">[g10 g11 h11 …]_geo = M * [g10 g11 h11 …]_gsm</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="coordinate_utils.rotate_gauss_fft">
<code class="descclassname">coordinate_utils.</code><code class="descname">rotate_gauss_fft</code><span class="sig-paren">(</span><em>nmax</em>, <em>kmax</em>, <em>*</em>, <em>step=None</em>, <em>N=None</em>, <em>filter=None</em>, <em>save_to=False</em>, <em>reference=None</em><span class="sig-paren">)</span><a class="headerlink" href="#coordinate_utils.rotate_gauss_fft" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute Fourier components of the timeseries of matrices that transform
spherical harmonic expansions (degree <code class="docutils literal notranslate"><span class="pre">kmax</span></code>) from a time-dependent
reference system (e.g. GSM, SM) to GEO (degree <code class="docutils literal notranslate"><span class="pre">nmax</span></code>).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>nmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Maximum degree of spherical harmonic expansion with respect to
geographic reference (target reference system).</p>
</dd>
<dt><strong>kmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Maximum degree of spherical harmonic expansion with respect to rotated
reference system.</p>
</dd>
<dt><strong>step</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Sample spacing given in hours (default is 1.0 hour).</p>
</dd>
<dt><strong>N</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd><p class="first last">Number of samples for which to evaluate the FFT (default is
N = 8*365.25*24 equiv. to 8 years using default sample spacing).</p>
</dd>
<dt><strong>filter</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd><p class="first last">Set filter length, i.e. number of Fourier components to be saved
(default is <code class="docutils literal notranslate"><span class="pre">N</span></code>).</p>
</dd>
<dt><strong>save_to</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">File to store output in npz-format in
<code class="docutils literal notranslate"><span class="pre">chaosmagpy/lib/frequency_spectrum_{reference}.npz</span></code> (default is
False).</p>
</dd>
<dt><strong>reference</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{‘gsm’, ‘sm’}, optional</span></dt>
<dd><p class="first last">Time-dependent reference system (default is GSM).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>frequency, frequency_ind</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (<code class="docutils literal notranslate"><span class="pre">filter</span></code>, <code class="docutils literal notranslate"><span class="pre">nmax</span></code> * (<code class="docutils literal notranslate"><span class="pre">nmax</span></code> + 2), <code class="docutils literal notranslate"><span class="pre">kmax</span></code> * (<code class="docutils literal notranslate"><span class="pre">kmax</span></code> + 2))</span></dt>
<dd><p class="first last">Unsorted vector of frequencies in 1/days. (positive, excluding aliases)</p>
</dd>
<dt><strong>spectrum, spectrum_ind</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (<code class="docutils literal notranslate"><span class="pre">filter</span></code>, <code class="docutils literal notranslate"><span class="pre">nmax</span></code> * (<code class="docutils literal notranslate"><span class="pre">nmax</span></code> + 2), <code class="docutils literal notranslate"><span class="pre">kmax</span></code> * (<code class="docutils literal notranslate"><span class="pre">kmax</span></code> + 2))</span></dt>
<dd><p class="first last">Complex fourier spectrum of rotation matrices to transform spherical
harmonic expansions. It also applies a conductivity model to derive the
transform for the induced field.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>If <code class="docutils literal notranslate"><span class="pre">save_to=True</span></code>, then an <code class="docutils literal notranslate"><span class="pre">*.npz</span></code>-file is written with the following
keywords {‘frequency’, ‘spectrum’, ‘frequency_ind’, ‘spectrum_ind’,
‘step’, ‘N’, ‘filter’, ‘reference’, ‘dipole’}. <code class="docutils literal notranslate"><span class="pre">'dipole'</span></code> means the three
geographic components of the unit vector that is anti-parallel to the
IGRF-dipole.</p>
</dd></dl>

<dl class="function">
<dt id="coordinate_utils.spherical_to_cartesian">
<code class="descclassname">coordinate_utils.</code><code class="descname">spherical_to_cartesian</code><span class="sig-paren">(</span><em>radius</em>, <em>theta</em>, <em>phi</em><span class="sig-paren">)</span><a class="headerlink" href="#coordinate_utils.spherical_to_cartesian" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert geocentric spherical to cartesian coordinates.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>radius</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Geocentric radius.</p>
</dd>
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Geocentric colatitude in degrees.</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Geocentric longitude in degrees.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>x, y, z</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape(…)</span></dt>
<dd><p class="first last">Cartesian coordinates.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="coordinate_utils.sun_position">
<code class="descclassname">coordinate_utils.</code><code class="descname">sun_position</code><span class="sig-paren">(</span><em>time</em><span class="sig-paren">)</span><a class="headerlink" href="#coordinate_utils.sun_position" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the sun’s position in longitude and colatitude given time
(mjd2000). It is accurate for years 1901 through 2099, to within 0.006 deg.
Input shape is preserved.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…)</span></dt>
<dd><p class="first last">Time given as modified Julian date, i.e. with respect to the date 0h00
January 1, 2000 (mjd2000).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…)</span></dt>
<dd><p class="first last">Geocentric colatitude of sun’s position in degrees
<span class="math notranslate nohighlight">\([0^\circ, 180^\circ]\)</span>.</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…)</span></dt>
<dd><p class="first last">Geocentric east longtiude of sun’s position in degrees
<span class="math notranslate nohighlight">\((-180^\circ, 180^\circ]\)</span>.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Taken from <a class="reference external" href="http://jsoc.stanford.edu/doc/keywords/Chris_Russel/Geophysical%20Coordinate%20Transformations.htm#appendix2">here</a></p>
</dd></dl>

<dl class="function">
<dt id="coordinate_utils.synth_rotate_gauss">
<code class="descclassname">coordinate_utils.</code><code class="descname">synth_rotate_gauss</code><span class="sig-paren">(</span><em>time</em>, <em>frequency</em>, <em>spectrum</em><span class="sig-paren">)</span><a class="headerlink" href="#coordinate_utils.synth_rotate_gauss" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute matrices to transform sphercial harmonic expansion from
time-dependent reference system (e.g. GSM, SM) to GEO based on Fourier
components.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…)</span></dt>
<dd><p class="first last">Time given as modified Julian date, i.e. with respect to the date 0h00
January 1, 2000 (mjd2000).</p>
</dd>
<dt><strong>frequency</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (k,) or (k, m, n)</span></dt>
<dd><p class="first last">Vector of frequencies given in oscillations per day.</p>
</dd>
<dt><strong>spectrum</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (k, m, n)</span></dt>
<dd><p class="first last">Fourier components of the matrices (reside in the last two dimensions).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>matrix</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…, m, n)</span></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="coordinate_utils.transform_points">
<code class="descclassname">coordinate_utils.</code><code class="descname">transform_points</code><span class="sig-paren">(</span><em>theta</em>, <em>phi</em>, <em>time=None</em>, <em>*</em>, <em>reference=None</em>, <em>inverse=False</em><span class="sig-paren">)</span><a class="headerlink" href="#coordinate_utils.transform_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms spherical geographic coordinates into spherical coordinates of
a target reference system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Geocentric colatitude in degrees.</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Geocentric longtiude in degrees.</p>
</dd>
<dt><strong>time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Time given as modified Julian date, i.e. with respect to the date 0h00
January 1, 2000 (mjd2000). Ignored for <code class="docutils literal notranslate"><span class="pre">reference='mag'</span></code>.</p>
</dd>
<dt><strong>reference</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{‘gsm’, ‘sm’, ‘mag’}</span></dt>
<dd><p class="first last">Target reference system for points provided in GEO</p>
</dd>
<dt><strong>inverse</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd><p class="first last">Use inverse transformation instead, i.e. transform from rotated
coordinates to geographic (default is False).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…)</span></dt>
<dd><p class="first last">Target reference colatitude in degrees <span class="math notranslate nohighlight">\([0^\circ, 180^\circ]\)</span>.</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…)</span></dt>
<dd><p class="first last">Target reference longitude in degrees
<span class="math notranslate nohighlight">\((-180^\circ, 180^\circ]\)</span>.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#coordinate_utils.geo_to_base" title="coordinate_utils.geo_to_base"><code class="xref py py-obj docutils literal notranslate"><span class="pre">geo_to_base</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="coordinate_utils.transform_vectors">
<code class="descclassname">coordinate_utils.</code><code class="descname">transform_vectors</code><span class="sig-paren">(</span><em>theta</em>, <em>phi</em>, <em>B_theta</em>, <em>B_phi</em>, <em>time=None</em>, <em>reference=None</em>, <em>inverse=False</em><span class="sig-paren">)</span><a class="headerlink" href="#coordinate_utils.transform_vectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes matrix to rotate vectors from USE (Up-South-East) frame at
spherical geographic coordinates (theta, phi) to USE frame at spherical
target reference coordinates.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Geocentric colatitude in degrees.</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Geocentric longitude in degrees.</p>
</dd>
<dt><strong>B_theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Colatitude vector components.</p>
</dd>
<dt><strong>B_phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Azimuthal vector components.</p>
</dd>
<dt><strong>time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Time given as modified Julian date, i.e. with respect to the date 0h00
January 1, 2000 (mjd2000). Ignored for <code class="docutils literal notranslate"><span class="pre">reference='mag'</span></code>.</p>
</dd>
<dt><strong>reference</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{‘gsm’, ‘sm’, ‘mag’}</span></dt>
<dd><p class="first last">Target reference system.</p>
</dd>
<dt><strong>inverse</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd><p class="first last">Use inverse transformation instead, i.e. transform from rotated
coordinates to geographic (default is False).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…)</span></dt>
<dd><p class="first last">Target reference colatitude in degrees <span class="math notranslate nohighlight">\([0^\circ, 180^\circ]\)</span>.</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…)</span></dt>
<dd><p class="first last">Target reference longitude in degrees
<span class="math notranslate nohighlight">\((-180^\circ, 180^\circ]\)</span>.</p>
</dd>
<dt><strong>B_theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Colatitude vector components in the target reference.</p>
</dd>
<dt><strong>B_phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Azimuthal vector components in the target reference.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#coordinate_utils.matrix_geo_to_base" title="coordinate_utils.matrix_geo_to_base"><code class="xref py py-obj docutils literal notranslate"><span class="pre">matrix_geo_to_base</span></code></a></p>
</div>
</dd></dl>

</div>
<div class="section" id="module-model_utils">
<span id="model-utilities-model-utils"></span><h3>Model utilities (<cite>model_utils</cite>)<a class="headerlink" href="#module-model_utils" title="Permalink to this headline">¶</a></h3>
<p>Functions for building the CHAOS model.</p>
<dl class="function">
<dt id="model_utils.augment_breaks">
<code class="descclassname">model_utils.</code><code class="descname">augment_breaks</code><span class="sig-paren">(</span><em>breaks</em>, <em>order</em><span class="sig-paren">)</span><a class="headerlink" href="#model_utils.augment_breaks" title="Permalink to this definition">¶</a></dt>
<dd><p>Augments a vector of break points and returns the knot vector for a
B-spline representation of order <cite>k</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>breaks: ndarray, shape (n,)</strong></dt>
<dd><p class="first last">1-D array, containing <cite>n</cite> break points (without endpoint repeats).</p>
</dd>
<dt><strong>order: int, positive</strong></dt>
<dd><p class="first last">Order <cite>k</cite> of B-spline (4 = cubic).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>knots: ndarray, shape (n+2k-2,)</strong></dt>
<dd><p class="first last">1-D array with <cite>k</cite>-times repeated copies of the <cite>breaks</cite>-vector
endpoints <code class="docutils literal notranslate"><span class="pre">breaks[0]</span></code> and <code class="docutils literal notranslate"><span class="pre">breaks[-1]</span></code>.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="model_utils.colloc_matrix">
<code class="descclassname">model_utils.</code><code class="descname">colloc_matrix</code><span class="sig-paren">(</span><em>x</em>, <em>knots</em>, <em>order</em><span class="sig-paren">)</span><a class="headerlink" href="#model_utils.colloc_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Create collocation matrix of a univariate function on <cite>x</cite> in terms a
B-spline representation of order <cite>k</cite>. The computation of the splines is
based on the scipy-package.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>x</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (N,)</span></dt>
<dd><p class="first last"><cite>N</cite> points to evaluate the B-spline at.</p>
</dd>
<dt><strong>knots</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape &gt;= (k+1,)</span></dt>
<dd><p class="first last">Vector of knots derived from breaks (with appropriate endpoint
multiplicity).</p>
</dd>
<dt><strong>order</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive</span></dt>
<dd><p class="first last">Order <cite>k</cite> of the B-spline (4 = cubic).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>collmat</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (N, n-k)</span></dt>
<dd><p class="first last">Collocation matrix, <cite>n</cite> is the size of <cite>knots</cite>.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#model_utils.augment_breaks" title="model_utils.augment_breaks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">augment_breaks</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="model_utils.design_gauss">
<code class="descclassname">model_utils.</code><code class="descname">design_gauss</code><span class="sig-paren">(</span><em>radius</em>, <em>theta</em>, <em>phi</em>, <em>nmax</em>, <em>source=None</em><span class="sig-paren">)</span><a class="headerlink" href="#model_utils.design_gauss" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes matrices to connect the radial, colatitude and azimuthal field
components to the magnetic potential field in terms of spherical harmonic
coefficients (Schmidt quasi-normalized).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>radius</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (N,)</span></dt>
<dd><p class="first last">Array containing the radius of <cite>N</cite> data points in kilometers.</p>
</dd>
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (N,)</span></dt>
<dd><p class="first last">Array containing the colatitude in degrees
<span class="math notranslate nohighlight">\([0^\circ,180^\circ]\)</span>.</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (N,)</span></dt>
<dd><p class="first last">Array containing the longitude in degrees.</p>
</dd>
<dt><strong>nmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive</span></dt>
<dd><p class="first last">Maximum degree of the sphercial harmonic expansion.</p>
</dd>
<dt><strong>source</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{‘internal’, ‘external’}, optional</span></dt>
<dd><p class="first last">Magnetic field source (default is an internal source).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>A_radius, A_theta, A_phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (N, <code class="docutils literal notranslate"><span class="pre">nmax</span></code> * (<code class="docutils literal notranslate"><span class="pre">nmax</span></code> + 2))</span></dt>
<dd><p class="first last">Matrices for radial, colatitude and azimuthal field components.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="model_utils.design_matrix">
<code class="descclassname">model_utils.</code><code class="descname">design_matrix</code><span class="sig-paren">(</span><em>knots</em>, <em>order</em>, <em>n_tdep</em>, <em>time</em>, <em>radius</em>, <em>theta</em>, <em>phi</em>, <em>n_static=None</em>, <em>source=None</em><span class="sig-paren">)</span><a class="headerlink" href="#model_utils.design_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns matrices that connect radial, colatitude and azimuthal field
components on a grid with <cite>radius</cite>, <cite>theta</cite> (colatitude) and <cite>phi</cite>
with the spherical harmonics expansion of a potential. The potential is
time-dependent on large length-scales (<cite>n</cite> &lt;= <cite>n_tdep</cite>) and static on small
length-scales (<cite>n_tdep</cite> &lt; <cite>n</cite> &lt;= <cite>n_static</cite>). The time-dependent part uses
a B-spline representation of order <cite>k</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>knots</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape &gt;= (k+1,)</span></dt>
<dd><p class="first last">Knot vector with adequate endpoint multiplicity.</p>
</dd>
<dt><strong>order</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive</span></dt>
<dd><p class="first last">Order <cite>k</cite> of B-spline basis functions (4 = cubic).</p>
</dd>
<dt><strong>n_tdep</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive</span></dt>
<dd><p class="first last">Maximum degree of the time-dependent field.</p>
</dd>
<dt><strong>time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (N,)</span></dt>
<dd><p class="first last">Time vector of the <cite>N</cite> data points in days.</p>
</dd>
<dt><strong>radius</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (N,)</span></dt>
<dd><p class="first last">Radius vector of the <cite>N</cite> data points in kilometers.</p>
</dd>
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (N,)</span></dt>
<dd><p class="first last">Data colatitude vector in degrees <span class="math notranslate nohighlight">\([0^\circ,180^\circ]\)</span>.</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (N,)</span></dt>
<dd><p class="first last">Data longitude vector in degrees.</p>
</dd>
<dt><strong>n_static</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive, optional</span></dt>
<dd><p class="first last">Maximum degree of static field (default is <code class="docutils literal notranslate"><span class="pre">None</span></code>,
<cite>n_static</cite> &gt; <cite>n_tdep</cite>).</p>
</dd>
<dt><strong>source</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{‘internal’, ‘external’}, optional</span></dt>
<dd><p class="first last">Magnetic field source (default is internal).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first docutils">
<dt><strong>G_radius, G_theta, G_phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (N, …)</span></dt>
<dd><p class="first last">Forward matrix for <span class="math notranslate nohighlight">\(B_r\)</span>, <span class="math notranslate nohighlight">\(B_{\theta}\)</span> and
<span class="math notranslate nohighlight">\(B_{\phi}\)</span>.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>ValueError</strong></dt>
<dd><p class="first last">If degree of static field is smaller than the degree of the time-dep.
field. In order to exclude the static field and obtain a purely
time-dependent potential, use optional argument <code class="docutils literal notranslate"><span class="pre">n_static=None</span></code> or
leave out completely.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#model_utils.design_gauss" title="model_utils.design_gauss"><code class="xref py py-obj docutils literal notranslate"><span class="pre">design_gauss</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="model_utils.legendre_poly">
<code class="descclassname">model_utils.</code><code class="descname">legendre_poly</code><span class="sig-paren">(</span><em>nmax</em>, <em>theta</em><span class="sig-paren">)</span><a class="headerlink" href="#model_utils.legendre_poly" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns associated Legendre polynomials <cite>P(n,m)</cite> (Schmidt quasi-normalized)
and the derivative <cite>dP(n,m)</cite> vrt. <cite>theta</cite> evaluated at <cite>theta</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>nmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive</span></dt>
<dd><p class="first last">Maximum degree of the spherical expansion.</p>
</dd>
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…)</span></dt>
<dd><p class="first last">Colatitude in degrees <span class="math notranslate nohighlight">\([0^\circ, 180^\circ]\)</span>
of arbitrary shape.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>Pnm</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (n, m, …)</span></dt>
<dd><p class="first last">Evaluated values and derivatives, grid shape is appended as trailing
dimensions. <cite>P(n,m)</cite> := <code class="docutils literal notranslate"><span class="pre">Pnm[n,</span> <span class="pre">m,</span> <span class="pre">...]</span></code> and <cite>dP(n,m)</cite> :=
<code class="docutils literal notranslate"><span class="pre">Pnm[m,</span> <span class="pre">n+1,</span> <span class="pre">...]</span></code></p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="model_utils.synth_from_pp">
<code class="descclassname">model_utils.</code><code class="descname">synth_from_pp</code><span class="sig-paren">(</span><em>breaks</em>, <em>order</em>, <em>coeffs</em>, <em>time</em>, <em>radius</em>, <em>theta</em>, <em>phi</em>, <em>*</em>, <em>nmax=None</em>, <em>source=None</em>, <em>deriv=None</em>, <em>grid=None</em><span class="sig-paren">)</span><a class="headerlink" href="#model_utils.synth_from_pp" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute radial, colatitude and azimuthal field components from the magnetic
potential in terms of a spherical harmonic expansion in form of a
piecewise polynomial.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>breaks</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (m+1,)</span></dt>
<dd><p class="first last">1-D array, containing <cite>m+1</cite> break points (without endpoint repeats) for
<cite>m</cite> intervals.</p>
</dd>
<dt><strong>order</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive</span></dt>
<dd><p class="first last">Order <cite>k</cite> of piecewise polynomials (4 = cubic).</p>
</dd>
<dt><strong>coeffs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (k, m, nmax*(nmax+2))</span></dt>
<dd><p class="first last">Coefficients of the piecewise polynomials, where <cite>m</cite> is the number of
polynomial pieces. The trailing dimension is equal to the number of
expansion coefficients for each interval.</p>
</dd>
<dt><strong>time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…)</span></dt>
<dd><p class="first last">Array containing the time in days.</p>
</dd>
<dt><strong>radius</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…) or float</span></dt>
<dd><p class="first last">Array containing the radius in kilometers.</p>
</dd>
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…) or float</span></dt>
<dd><p class="first last">Array containing the colatitude in degrees
<span class="math notranslate nohighlight">\([0^\circ,180^\circ]\)</span>.</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…) or float</span></dt>
<dd><p class="first last">Array containing the longitude in degrees.</p>
</dd>
<dt><strong>nmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive, optional</span></dt>
<dd><p class="first last">Maximum degree harmonic expansion (default is given by <code class="docutils literal notranslate"><span class="pre">coeffs</span></code>,
but can also be smaller, if specified).</p>
</dd>
<dt><strong>source</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{‘internal’, ‘external’}, optional</span></dt>
<dd><p class="first last">Magnetic field source (default is an internal source).</p>
</dd>
<dt><strong>deriv</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive, optional</span></dt>
<dd><p class="first last">Derivative to be taken (default is 0).</p>
</dd>
<dt><strong>grid</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If <code class="docutils literal notranslate"><span class="pre">True</span></code>, field components are computed on a regular grid. Arrays
<code class="docutils literal notranslate"><span class="pre">theta``and</span> <span class="pre">``phi</span></code> must have one dimension less than the output grid
since the grid will be created as their outer product.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>B_radius, B_theta, B_phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…)</span></dt>
<dd><p class="first last">Radial, colatitude and azimuthal field components.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#model_utils.synth_values" title="model_utils.synth_values"><code class="xref py py-obj docutils literal notranslate"><span class="pre">synth_values</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="model_utils.synth_values">
<code class="descclassname">model_utils.</code><code class="descname">synth_values</code><span class="sig-paren">(</span><em>coeffs</em>, <em>radius</em>, <em>theta</em>, <em>phi</em>, <em>*</em>, <em>nmax=None</em>, <em>source=None</em>, <em>grid=None</em><span class="sig-paren">)</span><a class="headerlink" href="#model_utils.synth_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes radial, colatitude and azimuthal field components from the
magnetic potential field in terms of spherical harmonic coefficients.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>coeffs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (grid_shape, …) or (…,)</span></dt>
<dd><p class="first last">Coefficients of the spherical harmonic expansion. The last dimension is
equal to the number of coefficients at each grid point.</p>
</dd>
<dt><strong>radius</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (grid_shape)</span></dt>
<dd><p class="first last">Array containing the radius in kilometers.</p>
</dd>
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (grid_shape)</span></dt>
<dd><p class="first last">Array containing the colatitude in degrees
<span class="math notranslate nohighlight">\([0^\circ,180^\circ]\)</span>.</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (grid_shape)</span></dt>
<dd><p class="first last">Array containing the longitude in degrees.</p>
</dd>
<dt><strong>nmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive, optional</span></dt>
<dd><p class="first last">Maximum degree up to which expansion is to be used (default is given by
the <cite>coeffs</cite>, but can also be smaller if specified)</p>
</dd>
<dt><strong>source</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{‘internal’, ‘external’}, optional</span></dt>
<dd><p class="first last">Magnetic field source (default is an internal source).</p>
</dd>
<dt><strong>grid</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If <code class="docutils literal notranslate"><span class="pre">True</span></code>, field components are computed on a regular grid. Arrays
<code class="docutils literal notranslate"><span class="pre">theta``and</span> <span class="pre">``phi</span></code> must have one dimension less than the output grid
since the grid will be created as their outer product.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>B_radius, B_theta, B_phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (grid_shape)</span></dt>
<dd><p class="first last">Radial, colatitude and azimuthal field components.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The function can work with different grid shapes, the inputs are
broadcasted accordingly (<code class="docutils literal notranslate"><span class="pre">grid=False</span></code>, default).</p>
<ol class="arabic simple">
<li>Single point: grid coordinates are single element arrays, <code class="docutils literal notranslate"><span class="pre">coeffs</span></code>
must be a 1-D array.</li>
<li>Several points: grid coordinates are N-D arrays, <code class="docutils literal notranslate"><span class="pre">coeffs</span></code> is either
an (grid_shape, 1)-D array (each point comes with own field expansion)
or a 1-D array (points have the same field expansion).</li>
</ol>
</dd></dl>

</div>
<div class="section" id="module-plot_utils">
<span id="plotting-utilities-plot-utils"></span><h3>Plotting utilities (<cite>plot_utils</cite>)<a class="headerlink" href="#module-plot_utils" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="plot_utils.fmt">
<code class="descclassname">plot_utils.</code><code class="descname">fmt</code><span class="sig-paren">(</span><em>x</em>, <em>pos</em><span class="sig-paren">)</span><a class="headerlink" href="#plot_utils.fmt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="plot_utils.nio_colormap">
<code class="descclassname">plot_utils.</code><code class="descname">nio_colormap</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#plot_utils.nio_colormap" title="Permalink to this definition">¶</a></dt>
<dd><p>Define custom-built colormap ‘nio’ and register. Can be called in plots as
<code class="docutils literal notranslate"><span class="pre">cmap='nio'</span></code> after importing this module.</p>
</dd></dl>

<dl class="function">
<dt id="plot_utils.plot_maps">
<code class="descclassname">plot_utils.</code><code class="descname">plot_maps</code><span class="sig-paren">(</span><em>theta_grid</em>, <em>phi_grid</em>, <em>X</em>, <em>Y</em>, <em>Z</em>, <em>*</em>, <em>figsize=None</em>, <em>titles=None</em>, <em>label=None</em>, <em>cmap=None</em>, <em>climit=None</em><span class="sig-paren">)</span><a class="headerlink" href="#plot_utils.plot_maps" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="plot_utils.plot_timeseries">
<code class="descclassname">plot_utils.</code><code class="descname">plot_timeseries</code><span class="sig-paren">(</span><em>time</em>, <em>X</em>, <em>Y</em>, <em>Z</em>, <em>*</em>, <em>figsize=None</em>, <em>titles=None</em>, <em>label=None</em><span class="sig-paren">)</span><a class="headerlink" href="#plot_utils.plot_timeseries" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-data_utils">
<span id="data-utilities-data-utils"></span><h3>Data utilities (<cite>data_utils</cite>)<a class="headerlink" href="#module-data_utils" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="data_utils.gauss_units">
<code class="descclassname">data_utils.</code><code class="descname">gauss_units</code><span class="sig-paren">(</span><em>deriv</em><span class="sig-paren">)</span><a class="headerlink" href="#data_utils.gauss_units" title="Permalink to this definition">¶</a></dt>
<dd><p>Return string of the magnetic field units given the derivative with time.
String is meant to be parsed to plot labels.</p>
</dd></dl>

<dl class="function">
<dt id="data_utils.load_RC_datfile">
<code class="descclassname">data_utils.</code><code class="descname">load_RC_datfile</code><span class="sig-paren">(</span><em>filepath</em>, <em>parse_dates=None</em><span class="sig-paren">)</span><a class="headerlink" href="#data_utils.load_RC_datfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Load RC-index data file into pandas data frame.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>filepath</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">File path to RC-index dat-file.</p>
</dd>
<dt><strong>parse_dates</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">Replace index with datetime object for time-series manipulations.
Default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>df</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dataframe</span></dt>
<dd><p class="first last">Pandas dataframe with names {‘mjd2000’, ‘RC’, ‘RC_e’, ‘RC_i’, ‘flag’}.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="data_utils.load_shcfile">
<code class="descclassname">data_utils.</code><code class="descname">load_shcfile</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="headerlink" href="#data_utils.load_shcfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Load shc-file and return coefficient arrays.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>filepath</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">File path to spherical harmonic coefficient shc-file.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (N,)</span></dt>
<dd><p class="first last">Array containing <cite>N</cite> times for each model snapshot in decimal years.</p>
</dd>
<dt><strong>coeffs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (nmax(nmax+2), N)</span></dt>
<dd><p class="first last">Coefficients of model snapshots. Each column is a snapshot up to
spherical degree and order <cite>nmax</cite>.</p>
</dd>
<dt><strong>parameters</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict, {‘SHC’, ‘nmin’, ‘nmax’, ‘N’, ‘order’, ‘step’}</span></dt>
<dd><p class="first last">Dictionary containing parameters of the model snapshots and the
following keys: <code class="docutils literal notranslate"><span class="pre">'SHC'</span></code> shc-file name, <cite>nmin</cite> minimum degree,
<code class="docutils literal notranslate"><span class="pre">'nmax'</span></code> maximum degree, <code class="docutils literal notranslate"><span class="pre">'N'</span></code> number of snapshot models,
<code class="docutils literal notranslate"><span class="pre">'order'</span></code> piecewise polynomial order and <code class="docutils literal notranslate"><span class="pre">'step'</span></code> number of
snapshots until next break point. Extract break points of the
piecewise polynomial with <code class="docutils literal notranslate"><span class="pre">breaks</span> <span class="pre">=</span> <span class="pre">time[::step]</span></code>.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="data_utils.memory_usage">
<code class="descclassname">data_utils.</code><code class="descname">memory_usage</code><span class="sig-paren">(</span><em>pandas_obj</em><span class="sig-paren">)</span><a class="headerlink" href="#data_utils.memory_usage" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute memory usage of pandas object. For full report, use:
<code class="docutils literal notranslate"><span class="pre">df.info(memory_usage='deep')</span></code>.</p>
</dd></dl>

<dl class="function">
<dt id="data_utils.rsme">
<code class="descclassname">data_utils.</code><code class="descname">rsme</code><span class="sig-paren">(</span><em>x</em>, <em>y</em><span class="sig-paren">)</span><a class="headerlink" href="#data_utils.rsme" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute RSME (root square mean error) of inputs x and y.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>x, y</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></li>
<li><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></li>
<li><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></li>
</ul>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">API references</a><ul>
<li><a class="reference internal" href="#module-chaos">Core functionality (<cite>CHAOS</cite>)</a></li>
<li><a class="reference internal" href="#additional-functionality">Additional functionality</a><ul>
<li><a class="reference internal" href="#module-coordinate_utils">Coordinate transformations (<cite>coordinate_utils</cite>)</a></li>
<li><a class="reference internal" href="#module-model_utils">Model utilities (<cite>model_utils</cite>)</a></li>
<li><a class="reference internal" href="#module-plot_utils">Plotting utilities (<cite>plot_utils</cite>)</a></li>
<li><a class="reference internal" href="#module-data_utils">Data utilities (<cite>data_utils</cite>)</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#indices-and-tables">Indices and tables</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="usage.html"
                        title="previous chapter">Usage</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="changelog.html"
                        title="next chapter">Changelog</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/references.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="changelog.html" title="Changelog"
             >next</a> |</li>
        <li class="right" >
          <a href="usage.html" title="Usage"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">ChaosMagPy  documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Clemens Kloss.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.9.
    </div>
  </body>
</html>